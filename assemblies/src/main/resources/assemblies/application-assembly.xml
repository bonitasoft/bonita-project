<assembly xmlns="http://maven.apache.org/ASSEMBLY/2.2.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/ASSEMBLY/2.2.0 https://maven.apache.org/xsd/assembly-2.2.0.xsd">
    <id>${bonita.environment:lowercase}</id>
    <formats>
        <format>zip</format>
    </formats>
    <includeBaseDirectory>false</includeBaseDirectory>
    <fileSets>
        <fileSet>
            <outputDirectory>bdm</outputDirectory>
            <directory>../bdm</directory>
            <includes>
                <include>bdm_access_control.xml</include>
            </includes>
        </fileSet>
        <fileSet>
            <outputDirectory>profiles</outputDirectory>
            <directory>profiles</directory>
            <includes>
                <include>${include.profiles}</include>
            </includes>
            <excludes>
                <exclude>${exclude.profiles}</exclude>
            </excludes>
        </fileSet>
        <fileSet>
            <outputDirectory>applications</outputDirectory>
            <directory>applications</directory>
            <includes>
                <include>${include.applications}</include>
            </includes>
            <excludes>
                <exclude>${exclude.applications}</exclude>
            </excludes>
        </fileSet>
        <fileSet>
            <outputDirectory>organizations</outputDirectory>
            <directory>organizations</directory>
            <includes>
                <include>${include.organizations}</include>
            </includes>
            <excludes>
                <exclude>${exclude.organizations}</exclude>
            </excludes>
        </fileSet>
        <fileSet>
            <outputDirectory>processes</outputDirectory>
            <directory>${project.build.directory}/processes</directory>
            <includes>
                <include>${include.processes}</include>
            </includes>
            <excludes>
                <exclude>${exclude.processes}</exclude>
            </excludes>
        </fileSet>
        <fileSet>
            <outputDirectory>pages</outputDirectory>
            <directory>${project.build.directory}/pages</directory>
            <includes>
                <include>${include.pages}</include>
            </includes>
            <excludes>
                <exclude>${exclude.pages}</exclude>
            </excludes>
        </fileSet>
        <fileSet>
            <outputDirectory>pages</outputDirectory>
            <directory>${project.build.directory}/provided-pages</directory>
            <includes>
                <include>${include.pages}</include>
            </includes>
            <excludes>
                <exclude>${exclude.pages}</exclude>
            </excludes>
        </fileSet>
        <fileSet>
            <outputDirectory/>
            <directory>${project.build.directory}</directory>
            <includes>
                <include>application.properties</include>
            </includes>
        </fileSet>
    </fileSets>
    <moduleSets>
        <moduleSet>
            <useAllReactorProjects>true</useAllReactorProjects>
            <includes>
                <include>${project.groupId}:${project.artifactId}-bdm-model</include>
            </includes>
            <binaries>
                <unpack>false</unpack>
                <includeDependencies>false</includeDependencies>
                <outputDirectory>bdm</outputDirectory>
                <attachmentClassifier>descriptor</attachmentClassifier>
                <outputFileNameMapping>bdm.zip</outputFileNameMapping>
            </binaries>
        </moduleSet>
    </moduleSets>
    <dependencySets>
        <dependencySet>
            <scope>runtime</scope>
            <useProjectArtifact>false</useProjectArtifact>
            <useTransitiveDependencies>false</useTransitiveDependencies>
            <includes>
                <include>*:zip</include>
            </includes>
            <excludes>
                <!-- Application dependencies are handled in the dependencySet below-->
                <exclude>*:*:zip:application:*</exclude>
            </excludes>
            <outputDirectory>extensions</outputDirectory>
        </dependencySet>
        <dependencySet>
            <scope>runtime</scope>
            <useProjectArtifact>false</useProjectArtifact>
            <useTransitiveDependencies>false</useTransitiveDependencies>
            <includes>
                <include>*:*:zip:application:*</include>
            </includes>
            <unpack>true</unpack>
            <unpackOptions>
                <includes>
                    <include>**/pages/*.zip</include>
                </includes>
            </unpackOptions>
            <outputDirectory/>
        </dependencySet>
        <dependencySet>
            <scope>runtime</scope>
            <useProjectArtifact>false</useProjectArtifact>
            <useTransitiveDependencies>false</useTransitiveDependencies>
            <includes>
                <include>*:*:zip:application:*</include>
            </includes>
            <unpack>true</unpack>
            <unpackOptions>
                <includes>
                    <include>**/applications/*.xml</include>
                    <include>**/applications/*.png</include>
                </includes>
            </unpackOptions>
        </dependencySet>
        <dependencySet>
            <scope>runtime</scope>
            <useProjectArtifact>false</useProjectArtifact>
            <useTransitiveDependencies>false</useTransitiveDependencies>
            <includes>
                <include>*:*:zip:application:*</include>
            </includes>
            <unpack>true</unpack>
            <unpackOptions>
                <includes>
                    <include>**/extensions/*.zip</include>
                </includes>
            </unpackOptions>
        </dependencySet>
    </dependencySets>
</assembly>